<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <title>SMART App Launch</title>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="manifest" href="icons/site.webmanifest">

    <script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.js"></script>
</head>

<body>
    <p>正在連線至 EHR 系統並進行授權...</p>

    <script>
        // 清除舊的 SMART session，確保每次 launch 都是全新會話
        sessionStorage.clear();

        // FHIR.oauth2.authorize 會自動處理 URL 中的 iss 和 launch 參數
        FHIR.oauth2.authorize({
            "clientId": "my_web_app", // 模擬器環境可自訂
            "scope": "launch patient/*.read openid fhirUser",
            "redirectUri": "index.html" // 授權成功後跳轉回來的頁面
        });
    </script>
</body>

</html>